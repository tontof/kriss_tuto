<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>PHP</title>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="../lib/reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="../lib/reveal.js/css/theme/serif.css" id="theme"/>

<link rel="stylesheet" href="./inc/css/custom.css"/>
<link rel="stylesheet" href="../lib/reveal.js/lib/css/zenburn.css"/>
<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = '../lib/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="../lib/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<meta name="description" content="PHP Introduction.">
</head>
<body>
<div id="phpjs-compiler"><textarea id="phpjs-code"></textarea><div id="phpjs-results"><div id="phpjs-result"></div><div id="phpjs-html-result"></div></div><button id="phpjs-clear">Clear</button><button id="phpjs-close">Close</button><button id="phpjs-run">Run</button></div>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><div><h1>PHP</h1><h2></h2><h3><a href="mailto:"></a></h3></div>
</section>
<section id="table-of-contents">
<div id="table-of-contents">
<h2>Table des matières</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#/slide-sec-bases-php">1. Les bases en PHP</a></li>
<li><a href="#/slide-sec-php-form">2. Les formulaires</a></li>
<li><a href="#/slide-sec-cookies-sessions">3. Cookies et sessions</a></li>
<li><a href="#/slide-sec-php-fichiers">4. PHP et les fichiers</a></li>
<li><a href="#/slide-sec-php-sql">5. Bases de données SQL</a></li>
</ul>
</div>
</div>
</section>

<section id="slide-sec-bases-php">
<h2 id="bases-php"><a id="orge91ee9c"></a><span class="section-number-2">1</span> Les bases en PHP</h2>
</section>
<section id="slide-sec-1-1">
<h3 id="org3e099c3"><span class="section-number-3">1.1</span> Pourquoi PHP ?</h3>

<div class="figure">
<p><a href="http://www.commitstrip.com/fr/2015/01/12/the-right-tool-for-the-right-job/"><img src="./inc/img/Strip-PHP-doute650-Web.jpg" alt="Strip-PHP-doute650-Web.jpg" /></a>
</p>
</div>

</section>
<section id="slide-sec-1-2">
<h3 id="orgc01424a"><span class="section-number-3">1.2</span> Introduction à PHP</h3>
<ul>
<li><b><a href="http://php.net">PHP</a></b> (PHP: Hypertext Preprocessor)</li>
<li>Langage de programmation
<ul>
<li>impératif, procédural (suite d'instructions)</li>
<li>interprété côté serveur</li>
<li>libre</li>

</ul></li>
<li>Pages Web dynamiques</li>
<li>Logo : <img src="./inc/img/php.png" alt="php.png" /></li>
<li>Mascotte (Elephpant) : <img src="./inc/img/elephpant.png" alt="elephpant.png" /></li>

</ul>


</section>
<section id="slide-sec-1-2-1">
<h4 id="org61b2e31"><span class="section-number-4">1.2.1</span> Quelques versions de php</h4>
<ul>
<li><code>1.0 : 1995      :</code> <i>PHP: Personal Home Page</i></li>
<li><code>2.0 : 1997      :</code> Base du langage PHP actuel</li>
<li><code>3.0 : 1998-2000 :</code> <i>PHP: Hypertext Preprocessor</i></li>
<li><code>4.0 : 2000-2001 :</code> Zend engine</li>
<li><code>4.3 : 2002-2005 :</code> <i>CLI: Command line interface</i></li>
<li><code>5.0 : 2004-2005 :</code> Zend engine 2, Programmation objet</li>
<li><code>5.3 : 2009-2014 :</code> Namespace, closure</li>
<li><code>5.4 : 2012-2015 :</code> Trait</li>
<li><code>6.0 : ......... :</code> Unicode</li>
<li><code>7.0 : 2015-2018 :</code> Zend engine 3</li>

</ul>

</section>
<section id="slide-sec-hello-world">
<h4 id="hello-world"><a id="org590b4ef"></a><span class="section-number-4">1.2.2</span> Hello world</h4>
<ul>
<li>Créer un fichier avec l'extension .php</li>
<li>Insérer du code HTML et/ou PHP</li>
<li>Le code PHP doit être délimité par les balises <code>&lt;?php</code> et <code>?&gt;</code></li>
<li>Les instructions se terminent par <code>;</code></li>
<li>Les commentaires sont délimités par :
<ul>
<li><code>//</code> pour un commentaire sur une ligne</li>
<li><code>/*</code> pour un commentaire sur plusieurs lignes <code>*/</code></li>

</ul></li>

</ul>

<div class="org-src-container">

<pre id="phpjs-hello"><code class="src-php" >&lt;em&gt;&lt;?php
//* Comment hack
echo 'Hello world';
// */
?&gt;&lt;/em&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-3">
<h3 id="org0888574"><span class="section-number-3">1.3</span> Les types en PHP</h3>
<ul>
<li>types simples :
<ul>
<li>boolean</li>
<li>integer</li>
<li>float (avant double)</li>
<li>string</li>

</ul></li>
<li>types composés :
<ul>
<li>array (tableau)</li>
<li><i>object (objet)</i></li>

</ul></li>
<li>types spéciaux :
<ul>
<li><i>resource</i></li>
<li>NULL</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-1-3-1">
<h4 id="orgb44f7cb"><span class="section-number-4">1.3.1</span> Les booléens (boolean)</h4>
<ul>
<li>Type le plus simple pour exprimer une valeur de vérité.</li>
<li>Deux constantes insensibles à la casse :
<ul>
<li>TRUE (vrai)</li>
<li>FALSE (faux)</li>

</ul></li>

</ul>
<div class="org-src-container">

<pre id="phpjs-true"><code class="src-php" >&lt;?php echo TRUE; ?&gt; 
&lt;?php echo true; ?&gt; 
&lt;?php var_dump(TRUE); ?&gt; 
</code></pre>
</div>
<div class="org-src-container">

<pre id="phpjs-false"><code class="src-php" >&lt;?php echo FALSE; ?&gt; 
&lt;?php echo false; ?&gt; 
&lt;?php var_dump(FALSE); ?&gt; 
</code></pre>
</div>

</section>
<section id="slide-sec-1-3-2">
<h4 id="orgeb48d27"><span class="section-number-4">1.3.2</span> Les booléens (cast)</h4>
<ul>
<li>On utilise <code>(bool)</code> ou <code>(boolean)</code></li>
<li>Quand on convertit une valeur en booléen, sont considérés <code>false</code>  :
<ul>
<li>le booléen <code>false</code></li>
<li>l'entier <code>0</code></li>
<li>le réel <code>0.0</code></li>
<li>la chaîne vide <code> "" </code> et la chaîne <code> "0" </code></li>
<li>tout tableau vide</li>
<li>tout objet sans membre ni variable (PHP4)</li>
<li>le type <code>NULL</code> (ainsi que les variables non définies)</li>

</ul></li>
<li>Toutes les autres valeurs sont considérées comme <code>true</code></li>

</ul>

</section>
<section id="slide-sec-1-3-3">
<h4 id="org294d88c"><span class="section-number-4">1.3.3</span> Les booléens (exemple)</h4>
<div class="org-src-container">

<pre id="phpjs-boolean"><code class="src-" >&lt;?php
  var_dump((bool) ""); 
  var_dump((bool) 1); 
  var_dump((bool) -2); 
  var_dump((bool) "foo"); 
  var_dump((bool) 2.3); 
  var_dump((bool) array(12)); 
  var_dump((bool) array()); 
  var_dump((bool) "false"); 
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-3-4">
<h4 id="org97c858f"><span class="section-number-4">1.3.4</span> Les entiers (integer)</h4>
<ul>
<li>Un entier est un nombre de \({\mathbb{Z} = \{ \dots, -2, -1, 0, 1, 2, \dots\}}\)</li>
<li>Il peut se définir en :
<ul>
<li>décimal (base 10) : <span style="color:chocolate">42</span></li>
<li>hexadécimal (base 16) : <span style="color:chocolate">0x2A</span></li>
<li>octal (base 8) : <span style="color:chocolate">052</span></li>
<li>binaire (base 2) :  <span style="color:chocolate">0b101010</span> (PHP 5.4)</li>

</ul></li>
<li>Il peut être précédé du signe <code>-</code> ou <code>+</code></li>

</ul>

</section>
<section id="slide-sec-1-3-5">
<h4 id="orgec0a396"><span class="section-number-4">1.3.5</span> Les entiers (définis formellement)</h4>
<div class="org-src-container">

<pre><code class="text" >decimal     : [1-9][0-9]*      
            | 0                

hexadecimal : 0[xX][0-9a-fA-F]+

octal       : 0[0-7]+          

binary      : 0b[01]+          

integer     : [+-]?decimal     
            | [+-]?hexadecimal 
            | [+-]?octal       
            | [+-]?binary      
</code></pre>
</div>

</section>
<section id="slide-sec-1-3-6">
<h4 id="org4162d0b"><span class="section-number-4">1.3.6</span> Les entiers (cast)</h4>
<ul>
<li>On utilise <code>(int)</code> ou <code>(integer)</code></li>
<li><code>false</code> correspond à <code>0</code> et <code>true</code> à <code>1</code></li>
<li>Un réel sera arrondi vers <code>0</code></li>
<li>Seule la partie initiale d'une chaîne de caractères est prise en compte</li>
<li>Faire attention de manière générale à la conversion des autres types</li>

</ul>

</section>
<section id="slide-sec-1-3-7">
<h4 id="org0d8f16c"><span class="section-number-4">1.3.7</span> Les réels (float/double)</h4>
<ul>
<li>Un réel (nombre à virgule flottante) appartient à \({\mathbb{R}}\)</li>
<li>La taille d'un réel dépend de la plateforme, mais en général
<ul>
<li>max = ~1.8e308</li>
<li>précision de 14 chiffres</li>

</ul></li>
<li>Attention à la perte de précision : <a href="http://www.floating-point-gui.de/">http://www.floating-point-gui.de/</a></li>

</ul>

</section>
<section id="slide-sec-1-3-8">
<h4 id="org9964f57"><span class="section-number-4">1.3.8</span> Les réels (définis formellement)</h4>
<div class="org-src-container">

<pre><code class="text" >LNUM          [0-9]+                                   
DNUM          ([0-9]*[\.]{LNUM}) | ({LNUM}[\.][0-9]*)  
EXPONENT_DNUM [+-]?(({LNUM} | {DNUM}) [eE][+-]? {LNUM})
</code></pre>
</div>

</section>
<section id="slide-sec-1-3-9">
<h4 id="org164075a"><span class="section-number-4">1.3.9</span> Les réels (cast)</h4>
<ul>
<li>On utilise <code>(float)</code> ou <code>(double)</code></li>
<li>Seule la partie initiale d'une chaîne de caractères est prise en compte</li>
<li>Pour les autres types, l'élément est d'abord converti en <code>int</code> puis en <code>float</code></li>

</ul>

</section>
<section id="slide-sec-1-3-10">
<h4 id="orgca0de03"><span class="section-number-4">1.3.10</span> Les entiers et les réels (exemple)</h4>
<div class="org-src-container">

<pre id="phpjs-int-float"><code class="src-" >&lt;?php
//*
  var_dump(42); 
  var_dump(-42); 
  var_dump(052); 
  var_dump(0x2A); 
  var_dump((int)4.2);
  var_dump((int)"la réponse est 42");
  var_dump((int)"42, la réponse est");
  var_dump((float)"42.0 42");
// */
// Floating point problem
/*
  var_dump((int) ((0.1+0.7)*10)); 
  var_dump((int)1.999999999999999);
  var_dump((int)1.9999999999999999);
// */
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-3-11">
<h4 id="orge986a2f"><span class="section-number-4">1.3.11</span> Les chaînes de caractères (string)</h4>
<ul>
<li>Une chaîne de caractères correspond à un tableau d'octets.</li>
<li>Elle se définit à l'aide des <code> ' </code> ou <code> " </code></li>
<li>Les guillemets simples :
<ul>
<li>pour afficher <code> ' </code> il faut le préfixer par <code>\</code></li>
<li>pour afficher <code>\</code> il faut utiliser <code>\\</code></li>
<li>tous les autres caractères préfixés par <code>\</code> sont affichés (<code>\n</code>, <code>\r</code>)</li>

</ul></li>
<li>Les guillemets doubles :
<ul>
<li>pour afficher <code> " </code> il faut le préfixer par <code>\</code></li>
<li>les caractères préfixés par <code>\</code> sont interprêtés</li>
<li>les variables sont également interprêtées</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-1-3-12">
<h4 id="org236e3c3"><span class="section-number-4">1.3.12</span> Les chaînes de caractères (cast)</h4>
<ul>
<li>On utilise <code>(string)</code></li>
<li>Convertion automatique avec certaines fonctions comme <code>echo</code>, <code>print</code></li>
<li><code>true</code> est converti en <code> "1" </code> et <code>false</code> en <code> "" </code></li>

</ul>

</section>
<section id="slide-sec-1-3-13">
<h4 id="org28cc8b3"><span class="section-number-4">1.3.13</span> Les chaînes de caractères (affichage)</h4>
<ul>
<li><code>echo</code> et <code>print</code> ne sont pas de vraies fonctions (l'utilisation des parenthèses est facultative, mais recommandée)</li>
<li><p>
la fonction <a href="http://php.net/manual/en/function.printf.php"><code>printf</code></a> affiche une chaîne de caractère formatée et
retourne la longueur de la chaîne affichée
</p>
<div class="org-src-container">

<pre><code class="src-" >int printf (string $format [, mixed $args [, mixed $... ]] )
</code></pre>
</div></li>
<li><p>
la fonction <a href="http://php.net/manual/en/function.sprintf.php"><code>sprintf</code></a> retourne une chaîne formatée
</p>
<div class="org-src-container">

<pre><code class="src-" >string sprintf (string $format [, mixed $args [, mixed $... ]] )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-1-3-14">
<h4 id="org526eca0"><span class="section-number-4">1.3.14</span> Les chaînes de caractères (format)</h4>
<ul>
<li>Le format dépend du type du paramètre que l'on veut afficher
<ul>
<li><code> "%s" </code> pour une chaîne de caractères</li>
<li><code> "%d" </code> pour un entier</li>
<li><code> "%f" </code> pour un réel</li>

</ul></li>
<li>Il peut spécifier un affichage personnalisé
<ul>
<li><code> "%4d" </code> affiche un entier de 4 caractères préfixé par des espaces</li>
<li><code> "%'04d" </code> affiche un entier de 4 caractères préfixé par des <code>0</code></li>

</ul></li>
<li>Il permet de réordonner les paramètres
<ul>
<li><code> "%2$s" </code> affiche le 2<sup>e</sup> paramètre comme une chaîne de caractères</li>
<li><code> "%1$'04d" </code> affiche le 1<sup>er</sup> paramètre sous forme d'entier de
4 caractères minimum préfixé par des <code>0</code></li>

</ul></li>

</ul>

</section>
<section id="slide-sec-1-3-15">
<h4 id="org3b07b6b"><span class="section-number-4">1.3.15</span> Les chaînes de caractères (fonctions de base)</h4>
<ul>
<li><code>strlen </code> : retourne la longueur de la chaîne <code>$str</code></li>
<li><code>strcmp </code> : compare deux chaînes</li>
<li><code>trim   </code> : supprime les espaces ou un autre caractère<br />
<code>       </code>   en début (<code>ltrim</code>) et fin de chaîne (<code>rtrim</code>)</li>
<li><code>substr </code> : retourne une sous-chaîne</li>
<li><code>strpos </code> : cherche la position d'une sous-chaîne dans une autre chaîne</li>
<li><code>nl2br  </code> : remplace <code>\n</code> en <code>&lt;br&gt;</code></li>
<li><code>ucfirst</code> : première lettre en majuscule</li>
<li><code>ucwords</code> : première lettre de chaque mot en majuscule</li>
<li>D'autres fonctions <code>str_replace</code>, <code>strtolower</code>, <code>strtoupper</code>, <code>implode</code>, <code>explode</code> sur : <a href="http://php.net/manual/en/ref.strings.php">http://php.net/manual/en/ref.strings.php</a></li>

</ul>

</section>
<section id="slide-sec-1-3-16">
<h4 id="org4ef231a"><span class="section-number-4">1.3.16</span> Résumé (types simples)</h4>
<div class="org-src-container">

<pre id="phpjs-string"><code class="src-" >&lt;?php
  var_dump("0");
  var_dump("0" + 2);
  var_dump("0" + 1.3);
  var_dump("0" + true);
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-3-17">
<h4 id="org995bf9c"><span class="section-number-4">1.3.17</span> Les tableaux (array)</h4>
<ul>
<li>Il faut utiliser le mot clé <code>array()</code> (<code>[]</code> autorisé depuis PHP 5.4)</li>
<li>Chaque paramètre correspond à une paire <code>clé =&gt; valeur</code></li>
<li>Une clé peut-être un entier ou une chaîne de caractères
<ul>
<li>Une chaîne correspondant à un entier valide sera transformé en entier</li>
<li>Les autres types sont convertis en entiers</li>

</ul></li>
<li>Les clés sont optionnelles.</li>

</ul>

</section>
<section id="slide-sec-1-3-18">
<h4 id="org7af84fd"><span class="section-number-4">1.3.18</span> Les tableaux (fonctions de base)</h4>
<ul>
<li><code>count       </code> : retourne le nombre d'éléments contenus dans un tableau</li>
<li><code>sort        </code> : trie par rapport aux valeurs un tableau (<code>rsort</code> reverse)</li>
<li><code>asort       </code> : trie les valeurs en conservant les clés (<code>arsort</code> reverse)</li>
<li><code>ksort       </code> : trie les clés d'un tableau (<code>krsort</code> reverse)</li>
<li><code>array_keys  </code> : retourne les clés d'un tableau sous forme d'un tableau</li>
<li><code>array_values</code> : retourne les valeurs d'un tableau sous forme d'un tableau</li>
<li>D'autres fonctions <code>array_pop</code>, <code>array_shift</code>, <code>array_map</code> sur : <a href="http://php.net/manual/en/function.array.php">http://php.net/manual/en/function.array.php</a></li>

</ul>

</section>
<section id="slide-sec-1-3-19">
<h4 id="org8f9b8fc"><span class="section-number-4">1.3.19</span> Les tableaux (exemple)</h4>
<div class="org-src-container">

<pre id="phpjs-array"><code class="src-" >&lt;?php
  var_dump(array("a","b","c"));
  var_dump(array("a" =&gt; "b", 3 =&gt; "c"));
  var_dump(array("a", 3 =&gt; "b", "c"));
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-4">
<h3 id="org9e5e37f"><span class="section-number-3">1.4</span> Les variables et constantes</h3>
<div class="outline-text-3" id="text-1-4">
</div>
</section>
<section id="slide-sec-1-4-1">
<h4 id="orgf8bccbb"><span class="section-number-4">1.4.1</span> Les variables</h4>
<ul>
<li>Une variable est désignée par le signe <code>$</code></li>
<li>Le nom est sensible à la casse et commence par une lettre ou un
tiret du bas <code>_</code> suivi de lettres, de chiffres ou <code>_</code></li>
<li><code>$this</code> est une variable spéciale qui ne peut pas être modifiée</li>
<li>Il n'est pas obligatoire de déclarer et d'initialiser les variables (recommandé)</li>
<li>Le nom d'une variable peut être dynamique</li>

</ul>

</section>
<section id="slide-sec-1-4-2">
<h4 id="orgfc714df"><span class="section-number-4">1.4.2</span> Gérer le type d'une variable</h4>
<ul>
<li>La fonction <code>gettype()</code> permet d'obtenir une chaîne de caractères
correspondant au type de l'argument : <code>boolean</code>, <code>integer</code>,
<code>double</code>, <code>string</code>, <code>array</code>, <code>object</code>, <code>resource</code>, <code>NULL</code> ou
<code>unknown type</code>.</li>
<li>Les fonctions suivantes : <code>is_array()</code>, <code>is_bool()</code>,
<code>is_float()</code>, <code>is_int()</code>, <code>is_null()</code>, <code>is_numeric()</code>,
<code>is_object()</code>, <code>is_resource()</code>, <code>is_scalar()</code> (integer, float,
string and booleen), <code>is_string()</code> permettent de vérifier si un
argument est d'un type particulier.</li>
<li>Le typage est dynamique en PHP</li>

</ul>

</section>
<section id="slide-sec-1-4-3">
<h4 id="org6131802"><span class="section-number-4">1.4.3</span> Tester l'état d'une variable</h4>
<ul>
<li><code>empty()</code></li>
<li><code>is_null()</code></li>
<li><code>isset()</code></li>
<li><code>(bool)</code></li>
<li><a href="http://php.net/manual/en/types.comparisons.php">http://php.net/manual/en/types.comparisons.php</a></li>

</ul>

<div class="org-src-container">

<pre><code class="center" >  empty() !== (bool) 
is_null() !== isset()
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="center" >'php' == 0     =&gt; true 
0     == null  =&gt; true 
null  == 'php' =&gt; false
</code></pre>
</div>

</section>
<section id="slide-sec-1-4-4">
<h4 id="org461d6ba"><span class="section-number-4">1.4.4</span> Les constantes</h4>
<ul>
<li>Par définition, la valeur d'une constante ne peut pas être modifiée</li>
<li>On utilise par convention, un nom écrit en lettres capitales</li>
<li>La fonction <code>define</code> est utilisée</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-define"><code class="src-" >&lt;?php
  define('HELLO', 3); 
  $a = 'hello'; 
  $$a = 'world'; 
  var_dump(HELLO); 
  //var_dump('$a $hello HELLO'); 
  //var_dump("$a $hello $$a HELLO"); 
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-5">
<h3 id="org5c4ce4c"><span class="section-number-3">1.5</span> Les opérateurs</h3>
<ul>
<li>Les opérateurs arithmétiques</li>
<li>Les opérateurs d'affectation</li>
<li>Les opérateurs de comparaison</li>
<li>Les opérateurs d'incrémentation et décrémentation</li>
<li>L'opérateur ternaire</li>
<li>Les opérateurs logiques</li>
<li>Les autres opérateurs</li>

</ul>

</section>
<section id="slide-sec-1-5-1">
<h4 id="org2b79251"><span class="section-number-4">1.5.1</span> Les opérateurs arithmétiques</h4>
<ul>
<li><code>-$a     </code> : la négation</li>
<li><code>$a + $b </code> : l'addition</li>
<li><code>$a - $b </code> : la soustraction</li>
<li><code>$a * $b </code> : la multiplication</li>
<li><code>$a / $b </code> : la division</li>
<li><code>$a % $b </code> : le modulo</li>
<li><code>$a ** $b</code> : l'exponentielle (PHP 5.6)</li>

</ul>

</section>
<section id="slide-sec-1-5-2">
<h4 id="org530b3b8"><span class="section-number-4">1.5.2</span> Les opérateurs d'affectation</h4>
<ul>
<li>Le signe <code> = </code></li>
<li>Il est possible de combiner le signe <code> = </code> avec d'autres opérateurs</li>
<li>Le passage par référence est possible avec <code> &amp; </code></li>
<li>L'opérateur <code> * </code> du C n'a pas de signification en PHP</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-assign"><code class="src-" >&lt;?php
  $a = 3;
  $b = &amp;$a;
  $a += 4;
  var_dump($a); 
  var_dump($b);
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-5-3">
<h4 id="org7350be0"><span class="section-number-4">1.5.3</span> Les opérateurs de comparaison</h4>
<ul>
<li><code>$a == $b </code> : égalité des valeurs</li>
<li><code>$a === $b</code> : identité (égalité des valeurs et des types)</li>
<li><code>$a != $b </code> : différence</li>
<li><code>$a &lt;&gt; $b </code> : différence</li>
<li><code>$a !== $b</code> : non identité (différence des valeurs ou des types)</li>
<li><code>$a &lt; $b  </code> : infériorité</li>
<li><code>$a &gt; $b  </code> : supériorité</li>
<li><code>$a &lt;= $b </code> : infériorité ou égalité</li>
<li><code>$a &gt;= $b </code> : supériorité ou égalité</li>

</ul>

</section>
<section id="slide-sec-1-5-4">
<h4 id="org8d5c5a0"><span class="section-number-4">1.5.4</span> Les opérateurs d'incrémentation et décrémentation</h4>
<ul>
<li><code>++$a</code> : incrémente <code>$a</code>  de 1, puis retourne <code>$a</code></li>
<li><code>$a++</code> : retourne <code>$a</code> puis incrémente <code>$a</code>  de 1</li>
<li><code>--$a</code> : décrémente <code>$a</code>  de 1, puis retourne <code>$a</code></li>
<li><code>$a--</code> : retourne <code>$a</code> puis décrémente <code>$a</code>  de 1</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-incr-decr"><code class="src-" >&lt;?php
  $a = 3;
  var_dump($a++); 
  //var_dump($a);
  //var_dump(--$a); 
  //var_dump($a); 
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-5-5">
<h4 id="orgaaf9740"><span class="section-number-4">1.5.5</span> L'opérateur ternaire</h4>
<ul>
<li><code>?:</code> est un opérateur conditionnel ternaire</li>
<li><code>(expr1) ? (expr2) : (expr3)</code> est évalué à :
<ul>
<li><code>expr2</code> si <code>expr1</code> est évaluée à <code>true</code></li>
<li><code>expr3</code> si <code>expr1</code> est évaluée à <code>false</code></li>

</ul></li>
<li><code>expr2</code> n'est plus obligatoire depuis PHP 5.3</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-ternary"><code class="src-" >&lt;?php
  var_dump('1' == 1 ? 'oui' : 'non'); 
  var_dump('1' === 1 ? 'oui' : 'non'); 
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-5-6">
<h4 id="org7e28dbe"><span class="section-number-4">1.5.6</span> Les opérateurs logiques</h4>
<ul>
<li><code>$a &amp;&amp; $b </code> : <code>true</code> si <code>$a</code> et <code>$b</code> valent <code>true</code></li>
<li><code>$a and $b</code> : <code>true</code> si <code>$a</code> et <code>$b</code> valent <code>true</code></li>
<li><code>$a || $b </code> : <code>true</code> si <code>$a</code> vaut <code>true</code> ou <code>$b</code> vaut <code>true</code></li>
<li><code>$a or $b </code> : <code>true</code> si <code>$a</code> vaut <code>true</code> ou <code>$b</code> vaut <code>true</code></li>
<li><code>$a xor $b</code> : <code>true</code> si <code>$a</code> vaut <code>true</code> ou <code>$b</code> vaut <code>true</code> mais pas les 2</li>
<li><code>!$a      </code> : <code>true</code> si <code>$a</code> ne vaut pas <code>true</code></li>

</ul>

</section>
<section id="slide-sec-1-5-7">
<h4 id="org3efdabf"><span class="section-number-4">1.5.7</span> Les autres opérateurs</h4>
<ul>
<li><code>.</code> correspond à l'opération de concaténation pour les chaînes de caractères</li>
<li><code>[index]</code> permet d'accéder à un élément particulier d'un tableau</li>
<li><code>[]</code> permet assigner une valeur à la fin d'un tableau</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-array-op"><code class="src-" >&lt;?php
  $a = "hello ";
  $b = array($a);
  $b[] = "world";
  var_dump($a[4]);
  var_dump($a.$b[1]);
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-6">
<h3 id="orgf741a54"><span class="section-number-3">1.6</span> Les structures de contrôle</h3>
<ul>
<li>Les structures conditionnelles</li>
<li>Les structures répétitives</li>
<li>L'inclusion de fichiers</li>

</ul>

</section>
<section id="slide-sec-1-6-1">
<h4 id="org4b13442"><span class="section-number-4">1.6.1</span> Les structures conditionnelles (if, else, elseif)</h4>
<div class="org-src-container">

<pre><code class="src-" >if (condition) {
  instructions; // si condition évaluée à true
}
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="src-" >if (condition) {
  instructions; // si condition évaluée à true
} else {
  instructions; // si condition évaluée à false
}
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="src-" >if (condition1) {
  instructions; // si condition1 évaluée à true
} elseif (condition2) {
  instructions; // si condition1 évaluée à false et condition2 évaluée à true
} else {
  instructions; // si condition1 et condition 2 évaluées à false
}
</code></pre>
</div>

</section>
<section id="slide-sec-1-6-2">
<h4 id="org49260b4"><span class="section-number-4">1.6.2</span> Les structures conditionnelles (switch)</h4>
<div class="org-src-container">

<pre><code class="src-" >switch ($i) {
 case 0:
   echo "i equals 0";
   break;
 case 'a':
   echo "i equals a";
   break;
 default:
   echo "aucune valeur correspondante";
}
</code></pre>
</div>

<ul>
<li>équivalent à :</li>

</ul>

<div class="org-src-container">

<pre><code class="src-" >// == pas ===
if ($i == 0) {
  echo "i equals 0";
} elseif ($i == 'a') {
  echo "i equals 1";
} else {
  echo "aucune valeur correspondante";
}
</code></pre>
</div>

</section>
<section id="slide-sec-1-6-3">
<h4 id="org4fd4df1"><span class="section-number-4">1.6.3</span> Les structures répétitives (tant que)</h4>
<div class="org-src-container">

<pre><code class="src-" >while (condition) {
  instructions; // tant que condition est évaluée à true
}
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="src-" >do {
  instructions; // tant que condition est évaluée à true
} while (condition);
</code></pre>
</div>

</section>
<section id="slide-sec-1-6-4">
<h4 id="org1b608f1"><span class="section-number-4">1.6.4</span> Les structures répétitives (pour)</h4>
<div class="org-src-container">

<pre><code class="src-" >for (expr1; expr2; expr3) { // expr1 est exécutée une seule fois au début de la boucle
  instructions;             // exécuté tant que expr2 est évaluée à true
                            // expr3 est exécutée à la fin de chaque itération
}
</code></pre>
</div>

<ul>
<li>équivalent à :</li>

</ul>

<div class="org-src-container">

<pre><code class="src-" >expr1;
while (expr2) {
  instructions;
  expr3;
}
</code></pre>
</div>

</section>
<section id="slide-sec-1-6-5">
<h4 id="org36a262c"><span class="section-number-4">1.6.5</span> Les structures répétitives (tableau)</h4>
<ul>
<li><code>foreach</code> permet de parcourir les éléments d'un tableau</li>

</ul>

<div class="org-src-container">

<pre><code class="src-" >foreach (array as $value) {
  instructions;
}
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="src-" >foreach (array as $key =&gt; $value) {
  instructions;
}
</code></pre>
</div>

</section>
<section id="slide-sec-1-6-6">
<h4 id="org060a2d0"><span class="section-number-4">1.6.6</span> Exemple général sur les structures</h4>
<div class="org-src-container">

<pre id="phpjs-while-foreach-example"><code class="src-" >&lt;?php
  $i = 0;
  $values = array();
  while (count($values) &lt; 10) {
    $values[] = $i++;
  }
  $output = "values :";
  foreach($values as $value) {
    if ($value % 2) {
      $output .= ' ' . $value;
    }
  }
  echo $output;
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7">
<h3 id="orgbb1c748"><span class="section-number-3">1.7</span> Les fonctions</h3>
<ul>
<li>sont des blocs d'instructions que l'on peut répéter dans un programme</li>
<li>ne sont pas exécutées directement après leurs définitions</li>
<li>sont exécutées par un appel</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-function"><code class="src-" >&lt;?php
  function helloWorld() {
    echo "Hello world!";
  }

  helloWorld();
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7-1">
<h4 id="org6cb1cf1"><span class="section-number-4">1.7.1</span> Les arguments</h4>
<ul>
<li>Un argument est une variable, défini après le nom de la fonction entre paranthèses</li>
<li>Les arguments sont séparés par une virgule</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-function-args"><code class="src-" >&lt;?php
  function helloWorld($hello, $world) {
    echo "$hello $world!&lt;br&gt;\n";
  }

  helloWorld('Hello', 'world');
  helloWorld('Bonjour', 'tous');
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7-2">
<h4 id="orgf9e0ef4"><span class="section-number-4">1.7.2</span> Les valeurs par défaut</h4>
<ul>
<li>Il est possible de définir une valeur par défaut à un argument</li>
<li>Les arguments qui ont une valeur par défaut sont définis en dernier</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-function-default-args"><code class="src-" >&lt;?php
  function helloWorld($hello, $world = 'world') {
    echo "$hello $world!\n";
  }

  helloWorld('Bonjour', 'tous');
  helloWorld('Hello');
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7-3">
<h4 id="org828dd9e"><span class="section-number-4">1.7.3</span> Les retours</h4>
<ul>
<li>Tous les types de variables peuvent être retournés par une fonction</li>
<li>Si <code>return</code> est absent, <code>null</code> est retourné</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-function-return"><code class="src-" >&lt;?php
  function helloWorld() {
    return "Hello world!";
  }

  var_dump(helloWorld());
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7-4">
<h4 id="orge3d11d0"><span class="section-number-4">1.7.4</span> Retourner plusieurs valeurs</h4>
<ul>
<li>Il faut utiliser un tableau</li>

</ul>

<div class="org-src-container">

<pre id="phpjs-function-return-array"><code class="src-" >&lt;?php
  function helloWorld() {
    $result = array();

    $result[] = "Hello";
    $result[] = "world!";

    return $result;
  }

  echo implode(" ", helloWorld());
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7-5">
<h4 id="org59f493c"><span class="section-number-4">1.7.5</span> Arguments par référence</h4>
<div class="org-src-container">

<pre id="phpjs-function-args-reference"><code class="src-" >&lt;?php
  $hello = "Hello";
  $world = "World";
  function helloWorld($bonjour, &amp;$tous) {
    $bonjour = "Bonjour";
    $tous = "tous";
  }

  helloWorld($hello, $world);
  echo $hello." ".$world;
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-7-6">
<h4 id="orga0f2db4"><span class="section-number-4">1.7.6</span> Une fonction récursive</h4>
<div class="org-src-container">

<pre id="phpjs-function-rec"><code class="src-" >&lt;?php
  // affiche n fois la lettre 'o'
  function o($n) {
    $res = '';
    if ($n &gt; 0) {
      $res = 'o'.o($n -1);
    }
    return $res;
  }

  function helloWorld($n = 1) {
    echo 'Hell'.o($n)." world!\n";
  } 

  helloWorld();
  helloWorld(10);
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-1-8">
<h3 id="org76feb1b"><span class="section-number-3">1.8</span> Les variables prédéfinies</h3>
<ul>
<li><code>$_GET    </code> : variables de la méthode GET (dans l'url)</li>
<li><code>$_POST   </code> : variables de la méthode POST (dans l'entête HTTP)</li>
<li><code>$_REQUEST</code> : contenu de <code>$_GET</code>, <code>$_POST</code> (<code>$_COOKIE</code> : PHP &lt; 5.3)</li>
<li><code>$_FILES  </code> : gestion des fichiers uploadés</li>
<li><code>$_COOKIE </code> : variables des cookies HTTP (stockées chez le client)</li>
<li><code>$_SESSION</code> : variables de session (stockées sur le serveur)</li>
<li><code>$_SERVER </code> : variables de serveur et d'exécution</li>
<li><code>$GLOBALS </code> : variables disponibles dans le contexte global (<i>à éviter</i>)</li>
<li><code>$argc    </code> : nombre d'arguments passés au script (<code>CLI</code>)</li>
<li><code>$argv    </code> : tableau avec les arguments passés au script (<code>CLI</code>)</li>

</ul>

</section>
<section id="slide-sec-1-9">
<h3 id="org31f2743"><span class="section-number-3">1.9</span> <code>$_SERVER</code></h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>$_SERVER['DOCUMENT_ROOT']</code></td>
<td class="org-left">Racine du serveur</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['HTTP_ACCEPT_LANGUAGE']</code></td>
<td class="org-left">Langage accepté par le navigateur</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['HTTP_HOST']</code></td>
<td class="org-left">Nom de domaine du serveur</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['HTTP_USER_AGENT']</code></td>
<td class="org-left">Type de navigateur</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['PATH_INFO']</code></td>
<td class="org-left">Chemin WEB du script</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['REQUEST_URI']</code></td>
<td class="org-left">Chemin du script</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['REMOTE_ADDR']</code></td>
<td class="org-left">Adresse IP du client</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['REMOTE_PORT']</code></td>
<td class="org-left">Port de la requête HTTP</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['QUERY_STRING']</code></td>
<td class="org-left">Liste des paramètres passés au script</td>
</tr>

<tr>
<td class="org-left"><code>$_SERVER['SERVER_ADDR']</code></td>
<td class="org-left">Adresse IP du serveur</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-sec-php-form">
<h2 id="php-form"><a id="org473449a"></a><span class="section-number-2">2</span> Les formulaires</h2>
</section>
<section id="slide-sec-2-1">
<h3 id="org9f4cf82"><span class="section-number-3">2.1</span> GET</h3>
<div class="org-src-container">

<pre><code class="html" >GET form
<form action="<?php echo($_SERVER["PHP_SELF"]); ?>" method="get">
  <label>input :<input type="text" name="input"/></label><br>
  <button type="submit">Valider</button>
</form>
</code></pre>
</div>

<p>
<a href="./examples/form.php?filename=form_get">exemple</a>
</p>

</section>
<section id="slide-sec-2-2" data-state="alert">
<h3 id="org22700f5"><span class="section-number-3">2.2</span> Sécurité</h3>
<ul>
<li>Attention à l'utilisation de <code>$_SERVER["PHP_SELF"]</code></li>
<li>Attention aux données de l'utilisateur</li>

</ul>

</section>
<section id="slide-sec-2-2-1">
<h4 id="org041c363"><span class="section-number-4">2.2.1</span> <code>$_SERVER["PHP_SELF"]</code></h4>
<p>
<code>$_SERVER["PHP_SELF"]</code> permet de faire référence au script en cours
</p>

<ol class="org-ol">
<li><a id="org0bb6bec"></a>Problème<br />
<div class="org-src-container">

<pre><code class="html" ><form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST">
</code></pre>
</div>
<ul>
<li><code>/%22%3E%3Cscript%3Ealert('hacked')%3C/script%3E</code></li>
<li><a href="./examples/form.php/%22%3E%3Cscript%3Ealert('hacked')%3C/script%3E?filename=form_get">exemple</a></li>

</ul>
</li>

<li><a id="orgf9d5b27"></a>Solution<br />
<ul>
<li><code>filter_var($_SERVER['PHP_SELF'], FILTER_SANITIZE_STRING);</code></li>
<li><code>htmlspecialchars($_SERVER["PHP_SELF"]);</code></li>
<li><a href="./examples/form.php/%22%3E%3Cscript%3Ealert('hacked')%3C/script%3E?filename=form_post">exemple</a></li>
<li>il est également possible d'utiliser <code>action="" </code></li>

</ul>
</li>
</ol>

</section>
<section id="slide-sec-2-2-2">
<h4 id="org94ccdf4"><span class="section-number-4">2.2.2</span> Filtrer les données des utilisateurs</h4>
<p>
Never Trust User Input
</p>

<ol class="org-ol">
<li><a id="orga84ecc2"></a>Problème<br />
<ul>
<li>Un commentaire peut inclure du code malveillant</li>
<li>cross site scripting (XSS)</li>
<li><a href="./examples/form.php?input=&lt;script&gt;alert('hacked');&lt;/script&gt;">exemple</a></li>

</ul>
</li>

<li><a id="org748995f"></a>Solution<br />
<ul>
<li><code>htmlspecialchars()</code></li>
<li>Pas toujours suffisant si l'affichage est déjà dans une balise html</li>

</ul>
<div class="org-src-container">

<pre><code class="html" >$data = "javascript:alert('hacked');";
<img src="'.htmlspecialchars($data).'">
</code></pre>
</div>
<div class="org-src-container">

<pre><code class="html" ><img src="javascript:alert('hacked');">
</code></pre>
</div>
</li>
</ol>

</section>
<section id="slide-sec-2-3">
<h3 id="org939736b"><span class="section-number-3">2.3</span> POST</h3>
<div class="org-src-container">

<pre><code class="html" >POST form
<form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post">
  <label>input :<input type="text" name="input"/></label><br>
  <button type="submit">Valider</button>
</form>
</code></pre>
</div>

<p>
<a href="./examples/form.php?filename=form_post">exemple</a>
</p>

</section>
<section id="slide-sec-2-4">
<h3 id="org1c2b67f"><span class="section-number-3">2.4</span> Valeurs multiples</h3>
<div class="org-src-container">

<pre><code class="html" >Multiple POST form
<form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post">
  <p>
    Langues pratiquées :<br />
    <select name="lang[]" multiple size="4">
      <option value="français"> français</option>
      <option value="anglais"> anglais</option>
      <option value="allemand"> allemand</option>
      <option value="espagnol"> espagnol</option>
  </select>
  </p>
  <p>
    Compétences informatiques :<br />
    <label>HTML<input type="checkbox" name="input[]" value="HTML" /></label>
    <label>PHP<input type="checkbox" name="input[]" value="PHP" /></label>
    <label>MySQL<input type="checkbox" name="input[]" value="MySQL" /></label>
  </p>
  <input type="reset" value="EFFACER"/>
  <input type="submit" value="ENVOI"/>
</form>
</code></pre>
</div>

<ul>
<li><a href="./examples/form.php?filename=form_multiple_post">exemple POST</a></li>
<li><a href="./examples/form.php?filename=form_multiple_get">exemple GET</a></li>

</ul>

</section>
<section id="slide-sec-2-5">
<h3 id="org043bbd6"><span class="section-number-3">2.5</span> Buttons multiples</h3>
<div class="org-src-container">

<pre><code class="html" >Multiple button
<form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="get">
    <input type="submit" name="input" value="addition">
    <input type="submit" name="input" value="soustraction">
    <input type="submit" name="input" value="multiplication">
    <input type="submit" name="input" value="division">
</form>
</code></pre>
</div>

<ul>
<li><a href="./examples/form.php?filename=form_multiple_button">exemple</a></li>

</ul>

</section>
<section id="slide-sec-2-6">
<h3 id="orgd19de2e"><span class="section-number-3">2.6</span> <code>$_FILES</code></h3>
<ul>
<li>Envoi de fichiers (méthode <code>POST</code>)</li>
<li>Balise form avec l'attribut <code>enctype="multipart/form-data" </code></li>
<li>Type de fichiers acceptés <code>&lt;input type="file" accept="image/jpg"&gt;</code></li>
<li>Limite de la taille du fichier envoyé :
<ul>
<li><code>upload_max_filesize</code> du fichier <code>php.ini</code></li>
<li><code>&lt;input type="hidden" name="MAX_FILE_SIZE" value="120000"&gt;</code> en octets</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-2-7">
<h3 id="orga32fe4f"><span class="section-number-3">2.7</span> Informations liées aux fichiers</h3>
<ul>
<li><code>name    </code> : nom du fichier client</li>
<li><code>type    </code> : MIME du fichier client</li>
<li><code>tmp_name</code> : nom temporaire du fichier transféré</li>
<li><code>error   </code> : code d'erreur associé au fichier</li>
<li><code>size    </code> : taille du fichier transféré</li>

</ul>

</section>
<section id="slide-sec-2-8">
<h3 id="orgceabb12"><span class="section-number-3">2.8</span> Codes d'erreur</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code> 0 </code></td>
<td class="org-left"><code>UPLOAD_ERR_OK</code></td>
<td class="org-left">transfert réalisé avec succès</td>
</tr>

<tr>
<td class="org-left"><code> 1 </code></td>
<td class="org-left"><code>UPLOAD_ERR_INI_SIZE</code></td>
<td class="org-left">taille du fichier trop grande (<code>php.ini</code>)</td>
</tr>

<tr>
<td class="org-left"><code> 2 </code></td>
<td class="org-left"><code>UPLOAD_ERR_FORM_SIZE</code></td>
<td class="org-left">taille du fichier trop grande (<code>MAX_FILE_SIZE</code>)</td>
</tr>

<tr>
<td class="org-left"><code> 3 </code></td>
<td class="org-left"><code>UPLOAD_ERR_PARTIAL</code></td>
<td class="org-left">fichier partiellement transféré</td>
</tr>

<tr>
<td class="org-left"><code> 4 </code></td>
<td class="org-left"><code>UPLOAD_ERR_NOFILE</code></td>
<td class="org-left">aucun fichier transféré</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-sec-2-9">
<h3 id="org9afd00b"><span class="section-number-3">2.9</span> POST et FILES</h3>
<div class="org-src-container">

<pre><code class="html" >POST form with file
<form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>"
      method="post" enctype="multipart/form-data">
  <label>input :<input type="text" name="input"/></label><br>
  <label>file :<input type="file" name="file"/></label><br>
  <button type="submit">Valider</button>
</form>
</code></pre>
</div>

<p>
<a href="./examples/form.php?filename=form_post_file">exemple</a>
</p>

<div class="org-src-container">

<pre><code class="html" >POST form with files
<form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>"
      method="post" enctype="multipart/form-data">
  <label>input :<input type="text" name="input"/></label><br>
  <label>file[] :<input type="file" name="files[]"/></label><br>
  <label>file[] :<input type="file" name="files[]"/></label><br>
  <button type="submit">Valider</button>
</form>
</code></pre>
</div>

<p>
<a href="./examples/form.php?filename=form_post_files">exemple</a>
</p>

</section>
<section id="slide-sec-2-10">
<h3 id="orgfced31f"><span class="section-number-3">2.10</span> Déplacement des fichiers</h3>
<ul>
<li>Il faut utiliser la fonction <code>move_uploaded_file</code></li>
<li><code>move_uploaded_file($_FILES["file"]["tmp_name"], "monimage.jpg");</code>
<ul>
<li>retourne TRUE si le déplacement a réussi ou FALSE sinon</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-2-11">
<h3 id="org7442ca6"><span class="section-number-3">2.11</span> Validation</h3>
<ul>
<li>Never Trust User Input</li>
<li>La validation html5 n'est pas suffisante</li>
<li><p>
<a href="https://php.net/manual/en/function.filter-input.php"><code>filter_input</code></a>, <a href="https://php.net/manual/en/function.filter-var.php"><code>filter_var</code></a>
</p>
<div class="org-src-container">

<pre><code class="src-" >filter_var($email, FILTER_VALIDATE_EMAIL)
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-cookies-sessions">
<h2 id="cookies-sessions"><a id="orgcf486d9"></a><span class="section-number-2">3</span> Cookies et sessions</h2>
</section>
<section id="slide-sec-3-1">
<h3 id="orgb13606c"><span class="section-number-3">3.1</span> Les cookies</h3>
<ul>
<li>Les cookies permettent de stocker des informations côté client<br />
(Never Trust User Input)</li>
<li>L'écriture de cookie se fait avant tout envoi de contenu HTML au client</li>

</ul>

</section>
<section id="slide-sec-3-2">
<h3 id="org186277b"><span class="section-number-3">3.2</span> <a href="http://php.net/manual/en/function.setcookie.php">setcookie()</a></h3>
<div class="org-src-container">

<pre><code class="src-" >setcookie($name, $value, $expire, $path, $domain, $secure, $httponly)
</code></pre>
</div>
<p>
 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>$name</code></td>
<td class="org-left">(<i>obligatoire</i>)</td>
<td class="org-left">nom du cookie</td>
</tr>

<tr>
<td class="org-left"><code>$value</code></td>
<td class="org-left">(<i>facultatif</i>)</td>
<td class="org-left">valeur du cookie (chaîne de caractères)</td>
</tr>

<tr>
<td class="org-left"><code>$expire</code></td>
<td class="org-left">(<i>facultatif : 0</i>)</td>
<td class="org-left">date de fin de validité du cookie</td>
</tr>

<tr>
<td class="org-left"><code>$path</code></td>
<td class="org-left">(<i>facultatif</i>)</td>
<td class="org-left">chemin pour limiter l'accès au cookie</td>
</tr>

<tr>
<td class="org-left"><code>$domain</code></td>
<td class="org-left">(<i>facultatif</i>)</td>
<td class="org-left">domaine pour limiter l'accès au cookie</td>
</tr>

<tr>
<td class="org-left"><code>$secure</code></td>
<td class="org-left">(<i>facultatif : false</i>)</td>
<td class="org-left">HTTPS pour transmettre les cookies</td>
</tr>

<tr>
<td class="org-left"><code>$httponly</code></td>
<td class="org-left">(<i>facultatif : false</i>)</td>
<td class="org-left">utilisation uniquement du protocole HTTP</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-sec-3-3">
<h3 id="orga2e56e8"><span class="section-number-3">3.3</span> Affectation des cookies en PHP</h3>
<div class="org-src-container">

<pre><code class="src-" >setcookie('hello','world');
setcookie('couleur', 'red', time()+86400, '/mon-compte/', www.monsite.com, TRUE);

setcookie('tableau[index1]','val1');
setcookie('tableau[index2]','val2');
setcookie('tableau[index3]','val3');
</code></pre>
</div>

</section>
<section id="slide-sec-3-4">
<h3 id="org961f459"><span class="section-number-3">3.4</span> Lecture des cookies</h3>
<ul>
<li><code>$_COOKIE</code> est utilisé pour récupérer les valeurs</li>
<li>Attention, il n'est pas possible de lire une valeur associée
après un appel de setcookie, il faut qu'une requête ait lieu
entre le client et le serveur.</li>

</ul>

<div class="org-src-container">

<pre><code class="src-" >$hello = $_COOKIE['hello'];

foreach($_COOKIE['tableau'] as $key =&gt; $value) {
  echo 'Cookie : '. $key.' : '. $value;
}
</code></pre>
</div>

<p>
<a href="./examples/cookie.php">exemple</a>
</p>

</section>
<section id="slide-sec-3-5">
<h3 id="orgcad6a30"><span class="section-number-3">3.5</span> Les sessions</h3>
<ul>
<li>Les sessions permettent de stocker des informations côté serveur</li>
<li>Les sessions ne sont pas partagées entre les visiteurs</li>

</ul>

</section>
<section id="slide-sec-3-6">
<h3 id="orgfc6a973"><span class="section-number-3">3.6</span> Différentes étapes</h3>
<ul>
<li>Ouverture d'une session avec <code>session_start()</code></li>
<li>Transmission d'un identifiant de session</li>
<li>Utilisation de la variable <code>$_SESSION</code></li>
<li>Fermeture de la session</li>

</ul>

</section>
<section id="slide-sec-3-7">
<h3 id="org78c64a0"><span class="section-number-3">3.7</span> Transmission de l'identifiant de session</h3>
<ul>
<li>Dans l'URL à l'aide de la variable <code>SID</code> (Pas recommandé <i>htmlspecialchars</i>)</li>
<li>Avec les cookies (il faut que le client accepte les cookies)
<ul>
<li><code>ini_set('session.use_cookies', 1);</code></li>
<li><code>ini_set('session.use_only_cookies', 1);</code> par défaut depuis PHP 5.3</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-3-8">
<h3 id="orgbf4976a"><span class="section-number-3">3.8</span> Utilisation des sessions - 1</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
session_start();
if(isset($_POST['login']) &amp;&amp; isset($_POST['pass'])) {
    if($_POST['login']=="login" &amp;&amp; $_POST['pass']=="pass") {
        session_regenerate_id(true);
        $_SESSION['acces'] = true;
        $_SESSION['nom'] = $_POST['login'];
    }
} else {
    if (isset($_GET['logout'])) {
        session_unset();
        session_destroy();
        header("Location:session.php");
    }
}
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-3-9">
<h3 id="org04cf630"><span class="section-number-3">3.9</span> Utilisation des sessions - 2</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;form method="post" action=""&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Accès réservé aux personnes autorisées: Identifiez vous !
    &lt;/legend&gt;
    Login : &lt;input type="text" name="login"&gt;
    Pass : &lt;input type="password" name="pass" /&gt;
    &lt;input type="submit" name="envoi" value="Entrer"/&gt;
  &lt;/fieldset&gt;
&lt;/form&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-3-10">
<h3 id="orgad79a75"><span class="section-number-3">3.10</span> Utilisation des sessions - 3</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;p&gt; Visiter les pages du site &lt;br /&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href="session.php"&gt;Page d'accueil&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;a href="session_public.php"&gt;Page publique&lt;/a&gt;
    &lt;?php if(isset($_SESSION['public'])) echo " vue ". $_SESSION['public']. " fois"; ?&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;a href="session_protected.php"&gt;Page protégée &lt;/a&gt;
    &lt;?php if(isset($_SESSION['protected'])) echo " vue ". $_SESSION['protected']." fois"; ?&gt;
  &lt;/li&gt;
  &lt;?php if (isset($_SESSION['acces'])) { ?&gt;
  &lt;li&gt;&lt;a href="session.php?logout"&gt;Logout&lt;/a&gt;&lt;/li&gt;
  &lt;?php } ?&gt;
&lt;/ul&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-3-11">
<h3 id="org05f34ed"><span class="section-number-3">3.11</span> Utilisation des sessions - 4</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;p&gt;
&lt;?php
  echo "Nom de la session : ", session_name(),"&lt;br&gt;\n";
  echo "Id de la session : ", session_id(),"&lt;br&gt;\n";
?&gt;
&lt;/p&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-3-12">
<h3 id="orgb348cdc"><span class="section-number-3">3.12</span> Utilisation des sessions - 5</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
session_start();
$_SESSION['public'] ++;
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;La page publique&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;
      &lt;a href="session.php"&gt;Page d'accueil&lt;/a&gt;&lt;br&gt;
      &lt;?php echo "Page publique vue ". $_SESSION['public']. " fois"; ?&gt;
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-3-13">
<h3 id="org40c4e16"><span class="section-number-3">3.13</span> Utilisation des sessions - 6</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
session_start();
if(!isset($_SESSION['acces'])) {
    header("Location:session.php");
} else {
    $_SESSION['protected'] ++;
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;La page protégée&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;
      &lt;a href="session.php"&gt;Page d'accueil&lt;/a&gt;&lt;br&gt;
      &lt;?php echo "Page protégée vue ". $_SESSION['protected']. " fois"; ?&gt;&lt;br&gt;
      &lt;?php echo "&lt;h4&gt;Bonjour ". $_SESSION['nom']."&lt;/h4&gt;"; ?&gt;
      &lt;a href="session.php?logout"&gt;Logout&lt;/a&gt;
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>

<p>
<a href="./examples/session.php">exemple</a>
</p>

</section>
<section id="slide-sec-php-fichiers">
<h2 id="php-fichiers"><a id="orge90783d"></a><span class="section-number-2">4</span> PHP et les fichiers</h2>
</section>
<section id="slide-sec-4-1">
<h3 id="org627006a"><span class="section-number-3">4.1</span> L'inclusion de fichiers</h3>
<ul>
<li>Il est possible d'utiliser du code PHP ou HTML provenant d'autres fichiers :
<ul>
<li><code>include('fichier.ext');</code></li>
<li><code>require('fichier.ext');</code></li>
<li><code>include_once('fichier.ext');</code></li>
<li><code>require_once('fichier.ext');</code></li>

</ul></li>
<li>L'interpréteur PHP remplace ces lignes par le contenu du fichier</li>

</ul>

</section>
<section id="slide-sec-4-2">
<h3 id="org528623c"><span class="section-number-3">4.2</span> L'inclusion de fichiers</h3>
<ul>
<li>La différence entre <code>include</code> et <code>require</code> concerne la gestion des erreurs
<ul>
<li><code>include</code> génère un avertissement</li>
<li><code>require</code> génère une erreur fatale</li>

</ul></li>
<li>Le suffixe <code>_once</code> permet de ne remplacer qu'une seule fois le code</li>
<li>L'extension généralement utilisée est <code>.php</code> pour protéger le contenu</li>
<li>Permet d'extraire les fonctions d'usage</li>
<li>Améliore la modularité du code</li>

</ul>

</section>
<section id="slide-sec-4-3">
<h3 id="org71a5888"><span class="section-number-3">4.3</span> Manipulation simple des fichiers</h3>
<ul>
<li><code>file_exists()</code> permet de vérifier l'existence d'un fichier</li>
<li><code>file_get_contents()</code> permet de lire le contenu d'un fichier</li>
<li><code>file_put_contents()</code> permet d'écrire dans un fichier</li>

</ul>

<div class="org-src-container">

<pre><code class="src-" >&lt;?php
  $file = 'file.txt';
  $content = '';

  if (file_exists($file)) {
    $content = file_get_contents($file);
  }

  $content .= "Hello world\n";

  file_put_contents($file, $content);
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-4-4">
<h3 id="org7bba464"><span class="section-number-3">4.4</span> Manipulation simple des fichiers</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.readfile.php">readfile</a> lit et affiche le contenu d'un fichier 
</p>
<div class="org-src-container">

<pre><code class="src-" >int readfile ( string $filename )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.file.php">file</a> lit et retourne sous forme de tableau un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >array file ( string $filename )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-4-5">
<h3 id="org6ef84da"><span class="section-number-3">4.5</span> Manipulation avancée des fichiers</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.fopen.php">fopen</a> ouvre un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >resource fopen ( string $filename , string $mode)
</code></pre>
</div></li>
<li><code>$mode</code> :
<ul>
<li><code> 'r'  </code> : lecture seule</li>
<li><code> 'r+' </code> : lecture et écriture</li>
<li><code> 'w'  </code> : écriture seule (création du fichier si inexistant)</li>
<li><code> 'w+' </code> : lecture et écriture (création du fichier si inexistant)</li>
<li><code> 'a'  </code> : écriture seule comme <code>w</code> (écriture en fin de fichier)</li>
<li><code> 'a+' </code> : écriture et lecture comme <code>w+</code> (écriture en fin de fichier)</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-4-6">
<h3 id="org28e92c4"><span class="section-number-3">4.6</span> Déplacement</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.fseek.php">fseek</a> déplace le pointeur à une position donnée
</p>
<div class="org-src-container">

<pre><code class="src-" >int fseek ( resource $handle , int $offset )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.rewind.php">rewind</a>  remet le pointeur au début
</p>
<div class="org-src-container">

<pre><code class="src-" >bool rewind ( resource $handle )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.ftell.php">ftell</a> retourne la position du pointeur
</p>
<div class="org-src-container">

<pre><code class="src-" >int ftell ( resource $handle )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.feof.php">feof</a> test la fin du fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >bool feof ( resource $handle )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-4-7">
<h3 id="orgdaf4c40"><span class="section-number-3">4.7</span> Lecture</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.fread.php">fread</a> lecture du fichier en mode binaire
</p>
<div class="org-src-container">

<pre><code class="src-" >string fread ( resource $handle , int $length )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.fgets.php">fgets</a> lecture de la ligne courante
</p>
<div class="org-src-container">

<pre><code class="src-" >string fgets ( resource $handle [, int $length ] )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.fgetc.php">fgetc</a> lecture du caractère courant
</p>
<div class="org-src-container">

<pre><code class="src-" >string fgetc ( resource $handle )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-4-8">
<h3 id="org6d5208c"><span class="section-number-3">4.8</span> Écriture/Fermeture d'un fichier</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.fwrite.php">fwrite</a>/fputs écriture du fichier en mode binaire
</p>
<div class="org-src-container">

<pre><code class="src-" >int fwrite ( resource $handle , string $string [, int $length ] )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.fclose.php">fclose</a> fermeture du fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >bool fclose ( resource $handle )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-4-9">
<h3 id="orgad6b71e"><span class="section-number-3">4.9</span> Vérrouillage d'un fichier</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.flock.php">flock</a> vérrouille un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >bool flock ( resource $handle , int $operation )
</code></pre>
</div></li>
<li><code>$operation</code> :
<ul>
<li><code>LOCK_SH</code> bloque l'écriture du fichier mais laisse le libre accès en lecture à tous les utilisateurs</li>
<li><code>LOCK_EX</code> bloque l'écriture et la lecture du fichier</li>
<li><code>LOCK_UN</code> libère le verrou installé précédemment (ne pas oublier cette fonction à la fin des opérations de lecture et écriture)</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-4-10">
<h3 id="org1a7cc56"><span class="section-number-3">4.10</span> Résumé</h3>

<div class="figure">
<p><a href="http://www.luc-damas.fr/humeurs/pedagogie-houblonnee-les-fichiers/"><img src="./inc/img/pedagogie-houblonnee-fichiers.jpg" alt="pedagogie-houblonnee-fichiers.jpg" /></a>
</p>
</div>

</section>
<section id="slide-sec-4-11">
<h3 id="org9a18bb6"><span class="section-number-3">4.11</span> Exemple</h3>
<div class="org-src-container">

<pre><code class="src-" >&lt;?php
// Équivalent de file_get_contents
$file = "file.txt";
$handle = fopen($filename, "r");
if ($handle) {
  $content = fread($handle, filesize($file));
  fclose($handle);
}
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-4-12">
<h3 id="org737a165"><span class="section-number-3">4.12</span> csv</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.fgetcsv.php">fgetcsv</a> retourne sous forme de tableau un fichier CSV
</p>
<div class="org-src-container">

<pre><code class="src-" >array fgetcsv ( resource $handle 
                [, int $length = 0
                [, string $delimiter = ","
                [, string $enclosure = '"'
                [, string $escape = "\\" ]]]] )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.fputcsv.php">fputcsv</a> écrit une ligne CSV dans un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >int fputcsv ( resource $handle ,
              array $fields
              [, string $delimiter = ","
              [, string $enclosure = '"' ]] )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-4-13">
<h3 id="org5ab1a73"><span class="section-number-3">4.13</span> Action sur les fichiers</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.copy.php">copy</a> copie un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >bool copy ( string $source , string $dest )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.rename.php">rename</a> renomme unfichier
</p>
<div class="org-src-container">

<pre><code class="src-" >bool rename ( string $oldname , string $newname )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.unlink.php">unlink</a> supprime un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >bool unlink ( string $filename )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-4-14">
<h3 id="org34921d4"><span class="section-number-3">4.14</span> Information sur les fichiers</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/function.filesize.php">filesize</a> récupère la taille du fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >int filesize ( string $filename )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.fileatime.php">fileatime</a> donne la date du dernier accès à un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >int fileatime ( string $filename )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.filemtime.php">filemtime</a> donne la date de dernière modification d'un fichier
</p>
<div class="org-src-container">

<pre><code class="src-" >int filemtime ( string $filename )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.realpath.php">realpath</a> retourne le chemin absolu d'un chemin
</p>
<div class="org-src-container">

<pre><code class="src-" >string realpath ( string $path )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/function.basename.php">basename</a> retourne le nom du fichier d'un chemin
</p>
<div class="org-src-container">

<pre><code class="src-" >string basename ( string $path [, string $suffix ] )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-php-sql">
<h2 id="php-sql"><a id="orga2d466f"></a><span class="section-number-2">5</span> Bases de données SQL</h2>
</section>
<section id="slide-sec-5-1">
<h3 id="org6c883b4"><span class="section-number-3">5.1</span> Approches</h3>
<ul>
<li>Approche spécifique
<ul>
<li>MySQL : <a href="http://php.net/manual/en/book.mysqli.php">mysqli</a> (<a href="http://php.net/manual/en/ref.mysql.php">mysql</a> obsolète depuis PHP 5.5)</li>
<li>SQLite : <a href="http://php.net/manual/en/book.sqlite3.php">sqlite3</a></li>
<li>PostgreSQL : <a href="http://php.net/manual/en/book.pgsql.php">pgsql</a></li>

</ul></li>
<li>Approche générale
<ul>
<li>PHP Data Objects : <a href="http://php.net/manual/en/book.pdo.php">PDO</a></li>

</ul></li>

</ul>

</section>
<section id="slide-sec-5-2">
<h3 id="orgee12f4c"><span class="section-number-3">5.2</span> Approche spécifique</h3>
<ul>
<li>Avantages :
<ul>
<li>Permet d'utiliser les spécificités/fonctionnalités avancées de la base</li>
<li>Possède généralement de meilleures performances</li>

</ul></li>
<li>Inconvénient :
<ul>
<li>Contraint la base de données avec un code spécifique</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-5-3">
<h3 id="orgf9b3805"><span class="section-number-3">5.3</span> Approche générale</h3>
<ul>
<li>Avantages :
<ul>
<li>Code générique pour utiliser différents moteurs de bases de données</li>

</ul></li>
<li>Inconvénient :
<ul>
<li>Généricité à nuancer (<code>AUTOINCREMENT</code>, <code>AUTO_INCREMENT</code>)</li>
<li>Limité aux fonctionnalités de base</li>

</ul></li>

</ul>

</section>
<section id="slide-sec-5-4">
<h3 id="org0f1784a"><span class="section-number-3">5.4</span> Exemple</h3>
<div class="org-src-container">

<pre><code class="src-" >&lt;?php
  // mysqli
  $mysqli = new mysqli('example.com', 'user', 'password', 'database');
  $result = $mysqli-&gt;query("SELECT 'Bonjour, cher utilisateur de MySQL !' AS _message FROM DUAL");
  $row = $result-&gt;fetch_assoc();
  echo htmlentities($row['_message']);

  // PDO
  $pdo = new PDO('mysql:host=example.com;dbname=database', 'user', 'password');
  $statement = $pdo-&gt;query("SELECT 'Bonjour, cher utilisateur de MySQL !' AS _message FROM DUAL");
  $row = $statement-&gt;fetch(PDO::FETCH_ASSOC);
  echo htmlentities($row['_message']);
?&gt;
</code></pre>
</div>

<p>
<a href="http://php.net/manual/fr/mysqlinfo.api.choosing.php">http://php.net/manual/fr/mysqlinfo.api.choosing.php</a>
</p>

</section>
<section id="slide-sec-5-5">
<h3 id="orga37b0bd"><span class="section-number-3">5.5</span> PDO : créer une connexion</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  ini_set('display_errors', '1');
  error_reporting(E_ALL);
  $pdo = new PDO('mysql:host=localhost;dbname=database', 'user', 'password');
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_exception.php">exemple</a>
</p>

<div class="org-src-container">

<pre><code class="src" >&lt;?php
  ini_set('display_errors', '1');
  error_reporting(E_ALL);
  try {
    $pdo = new PDO('mysql:host=localhost;dbname=database', 'user', 'password');
  } catch(PDOException $e) {
    echo $e-&gt;getMessage();
  }
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_try.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-6">
<h3 id="org8637c04"><span class="section-number-3">5.6</span> PDO : fermer une connexion</h3>
<ul>
<li>Fermeture automatique à la fin du script</li>
<li>Mettre à null la variable qui gère la connexion</li>

</ul>

<div class="org-src-container">

<pre><code class="src" >&lt;?php
  try {
    // ouverture de la base de données
    $pdo = new PDO('sqlite::memory:');

    echo "Connecté à la base de données";

    // fermeture de la base de données
    $pdo = null;
  } catch(PDOException $e) {
    echo $e-&gt;getMessage();
  }
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-5-7">
<h3 id="orgfbfc90e"><span class="section-number-3">5.7</span> PDO : exec et query</h3>
<ul>
<li><p>
<a href="http://php.net/manual/en/pdo.exec.php">exec</a> execute une requête SQL et retourne le nombre de lignes affectées
</p>
<div class="org-src-container">

<pre><code class="src-" >public int PDO::exec ( string $statement )
</code></pre>
</div></li>
<li><p>
<a href="http://php.net/manual/en/pdo.query.php">query</a> execute une requête SQL et retourne un objet <a href="http://php.net/manual/fr/class.pdostatement.php">PDOStatement</a>
</p>
<div class="org-src-container">

<pre><code class="src-" >public PDOStatement PDO::query ( string $statement )
</code></pre>
</div></li>

</ul>

</section>
<section id="slide-sec-5-8">
<h3 id="org0ec0c1a"><span class="section-number-3">5.8</span> PDO : gestion des erreurs</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  ini_set('display_errors', '1');
  error_reporting(E_ALL);
  $error = isset($_GET['error'])?$_GET['error']:'default';
  try {
    $pdo = new PDO('sqlite::memory:');
    switch($error) {
    case 'exception':
      $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
      break;
    case 'warning':
      $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING);
      break;
    case 'silent':
      $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_SILENT);
      break;
    }

    var_dump($pdo-&gt;exec("Hello world"));
    echo '&lt;br&gt;Code erreur : '.$pdo-&gt;errorCode().'&lt;br&gt;';

    $pdo = null;
  } catch(PDOException $e) {
    echo $e-&gt;getMessage();
  }
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_error.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-9">
<h3 id="org05ed0e4"><span class="section-number-3">5.9</span> PDO : création</h3>
<ul>
<li>Pose le plus de problème pour la généricité du code car très
spécifique à la base utilisée</li>

</ul>

<div class="org-src-container">

<pre><code class="src" >&lt;?php
  error_reporting(E_ALL);
  ini_set('display_errors', '1');
  try {
    $pdo = new PDO('sqlite::memory:');
    $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $table = "CREATE TABLE animals (
      animal_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
      animal_type VARCHAR(25) NOT NULL,
      animal_name VARCHAR(25) NOT NULL 
    )";
    $pdo-&gt;exec($table);
  } catch(PDOException $e) {
    echo $e-&gt;getMessage();
  }
?&gt;
</code></pre>
</div>

</section>
<section id="slide-sec-5-10">
<h3 id="org9dc93e0"><span class="section-number-3">5.10</span> PDO : insertion</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_create.php';

  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('chien', 'médor')");
  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('vache', 'marguerite')");
  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('souris', 'jerry')");
  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('oiseau', 'titi')");
  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('chat', 'minou')");
  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('poisson', 'némo')");
  $pdo-&gt;exec("INSERT INTO animals (animal_type, animal_name) VALUES ('lapin', 'jeannot')");
  echo 'id du dernier animal inséré : '.$pdo-&gt;lastInsertId()."&lt;br&gt;\n";
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_insert.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-11">
<h3 id="org38f881e"><span class="section-number-3">5.11</span> PDO : sélection</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_insert.php';

  $sql = "SELECT * FROM animals";
  foreach ($pdo-&gt;query($sql) as $row) {
    print $row['animal_type'] .' - '. $row['animal_name'] . '&lt;br /&gt;';
  }
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_select.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-12">
<h3 id="org9c13123"><span class="section-number-3">5.12</span> PDO : parcours des données</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_insert.php';

  $sql = "SELECT * FROM animals";
  $stmt = $pdo-&gt;query($sql);

  echo '&lt;br&gt;&lt;b&gt;PDO::FETCH_ASSOC&lt;/b&gt;&lt;br&gt;'."\n";
  var_dump($stmt-&gt;fetch(PDO::FETCH_ASSOC));

  echo '&lt;br&gt;&lt;b&gt;PDO::FETCH_NUM&lt;/b&gt;&lt;br&gt;'."\n";
  var_dump($stmt-&gt;fetch(PDO::FETCH_NUM));

  echo '&lt;br&gt;&lt;b&gt;PDO::FETCH_BOTH&lt;/b&gt;&lt;br&gt;'."\n";
  var_dump($stmt-&gt;fetch(PDO::FETCH_BOTH));

  echo '&lt;br&gt;&lt;b&gt;fetchAll&lt;/b&gt;&lt;br&gt;'."\n";
  var_dump($stmt-&gt;fetchAll(PDO::FETCH_ASSOC));
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_select_fetch.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-13">
<h3 id="org9bb9479"><span class="section-number-3">5.13</span> PDO : mise à jour</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_insert.php';

  $count = $pdo-&gt;exec("UPDATE animals SET animal_name='mickey' WHERE animal_name='jerry'");

  echo $count.' animaux mis à jour';
  var_dump($pdo-&gt;query("SELECT * FROM animals")-&gt;fetchAll(PDO::FETCH_ASSOC));
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_update.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-14">
<h3 id="org92b4e86"><span class="section-number-3">5.14</span> PDO : suppression</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_insert.php';

  $count = $pdo-&gt;exec("DELETE FROM animals
                       WHERE animal_name = 'médor' OR animal_name = 'titi'");

  echo $count.' animaux supprimés';
  var_dump($pdo-&gt;query("SELECT * FROM animals")-&gt;fetchAll(PDO::FETCH_ASSOC));
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_delete.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-15">
<h3 id="org69b28d1"><span class="section-number-3">5.15</span> PDO : préparation</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_insert.php';

  // préparation d'une déclaration SQL
  $stmt = $pdo-&gt;prepare("SELECT * FROM animals
                         WHERE animal_name = :animal_name");

  // déclaration d'une variable
  $animal_name = 'minou';

  // lien entre la déclaration SQL et la variable
  $stmt-&gt;bindParam(':animal_name', $animal_name);

  // exécution de la requête et affichage des résultats
  $stmt-&gt;execute();
  var_dump($stmt-&gt;fetchAll());

  // modification des paramètres
  $animal_name = 'titi';
  $stmt-&gt;execute();
  var_dump($stmt-&gt;fetchAll());
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_prepare.php">exemple</a>
</p>

</section>
<section id="slide-sec-5-16">
<h3 id="orgdc4d138"><span class="section-number-3">5.16</span> PDO : fermeture du curseur</h3>
<div class="org-src-container">

<pre><code class="src" >&lt;?php
  include 'pdo_insert.php';

  // Création d'un objet PDOStatement
  $stmt = $pdo-&gt;prepare('SELECT animal_id FROM animals');

  // Création d'un second objet PDOStatement
  $otherStmt = $pdo-&gt;prepare('SELECT animal_name FROM animals');

  // Exécute la première requête
  $stmt-&gt;execute();

  // Récupération de la première ligne uniquement depuis le résultat
  var_dump($stmt-&gt;fetch());

  // L'appel suivant à closeCursor() peut être requis par quelques drivers
  $stmt-&gt;closeCursor();

  // Maintenant, nous pouvons exécuter la deuxième requête
  $otherStmt-&gt;execute();

  // Récupération de la première ligne uniquement depuis le résultat
  var_dump($otherStmt-&gt;fetch());
?&gt;
</code></pre>
</div>

<p>
<a href="./examples/pdo_close_cursor.php">exemple</a>
</p>
</section>
</section>
</div>
</div>
<div id="reveal-styles"><ul><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/default.css'); return false;" href="#">Black</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/blood.css'); return false;" href="#">Blood</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/sky.css'); return false;" href="#">Sky</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/beige.css'); return false;" href="#">Beige</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/simple.css'); return false;" href="#">Simple</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/serif.css'); return false;" href="#">Serif</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/night.css'); return false;" href="#">Night</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/moon.css'); return false;" href="#">Moon</a></li><li><a onclick="document.getElementById('theme').setAttribute('href','../lib/reveal.js/css/theme/solarized.css'); return false;" href="#">Solarized</a></li></ul></div>
<script src="../lib/reveal.js/lib/js/head.min.js"></script>
<script src="../lib/reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: false,
slideNumber: 'c',
rollingLinks: true,
keyboard: true,
overview: true,
width: 1200,
height: 800,
margin: 0.10,
minScale: 0.50,
maxScale: 2.50,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
{ src : '../lib/jquery/jquery.min.js' }, { src : '../lib/php.js/dist/php.min.js' }, { src : './inc/js/console.js' },
 { src: '../lib/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
 { src: '../lib/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: '../lib/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: '../lib/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
